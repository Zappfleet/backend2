// Copyright (c) 2010 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.


// Create one test item for each context type.
var contexts = ["selection"];
for (var i = 0; i < contexts.length; i++) {
  var context = contexts[i];
  var title = "Translate to Finglish";
  var id = chrome.contextMenus.create({"title": title, "contexts":[context],
                                       "onclick": function(info, tab) {
    sendSearch(info.selectionText);
}});
}


function sendSearch(selectedText) {


var serviceCall = 'http://f2f-onezeroir.rhcloud.com/?word=' + selectedText;

var xmlHttp = null;

    xmlHttp = new XMLHttpRequest();
    xmlHttp.open( "GET", serviceCall, false );
    xmlHttp.send( null );
	
	alert(xmlHttp.responseText);
	copyToClipboard(xmlHttp.responseText);

}

function copyToClipboard( text ){
                var copyDiv = document.createElement('div');
                copyDiv.contentEditable = true;
                document.body.appendChild(copyDiv);
                copyDiv.innerHTML = text;
                copyDiv.unselectable = "off";
                copyDiv.focus();
                document.execCommand('SelectAll');
                document.execCommand("Copy", false, null);
                document.body.removeChild(copyDiv);
            }